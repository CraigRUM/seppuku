(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{138:function(t,e,i){"use strict";i.r(e);var n=i(6),o=i.n(n),a=i(57),s=i.n(a),r=(i(78),i(8)),l=i(58),c=i.n(l),h=(i(79),i(34)),u=i.n(h),f=i(59),g=i.n(f),d=i(60),v=i.n(d),m=i(61),p=i.n(m),b=function(t){var e=t.ctxReady,i=Object(n.useState)(""),a=Object(r.a)(i,2),s=a[0],l=a[1],c=Object(n.useState)(""),h=Object(r.a)(c,2),f=h[0],d=h[1],m=Object(n.useState)(""),b=Object(r.a)(m,2),x=b[0],y=b[1],w=Object(n.useState)(""),k=Object(r.a)(w,2),E=k[0],j=k[1],O=Object(n.createRef)(),C=o.a.useRef(null),I=Object(n.useCallback)(function(){C.current&&l(C.current.getScreenshot())},[C]),L=o.a.createElement(g.a,{ref:C,screenshotFormat:"image/jpeg"});Object(n.useEffect)(function(){d(o.a.createElement("img",{onLoad:V,ref:R,src:s,alt:"Captured Image",id:"image"}))},[s]);var R=Object(n.useCallback)(function(t){y(t)},[f]),V=function(t){var e=t.target;j(e)};Object(n.useEffect)(function(){O.current&&(O.current.getContext("2d").drawImage(x,0,0),d(""),e(O.current))},[E]);var T=Object(n.useCallback)(function(t){l(null),j(null),d(""),e(null)},[]),Y=s?o.a.createElement("button",{className:u.a.uiButton,onClick:T},o.a.createElement("img",{src:p.a,alt:"reset"})):o.a.createElement("button",{className:u.a.uiButton,onClick:I},o.a.createElement("img",{src:v.a,alt:"take a picture"})),X=o.a.createElement("canvas",{ref:O,height:"480",width:"640"});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:u.a.CameraWrapper},s&&f,E&&X,!s&&L),Y)},x=i(0),y=i(1),w=function(){function t(e,i,n){Object(x.a)(this,t),this.x=void 0,this.y=void 0,this.rIndex=void 0,this.gIndex=void 0,this.bIndex=void 0,this.x=e,this.y=i,this.rIndex=4*(e+i*n),this.gIndex=this.rIndex+1,this.bIndex=this.gIndex+1}return Object(y.a)(t,[{key:"getColourAsHex",value:function(t){return"#".concat(this.hexVal(t[this.rIndex])).concat(this.hexVal(t[this.gIndex])).concat(this.hexVal(t[this.bIndex]))}},{key:"getColourMagnitued",value:function(t){return t[this.rIndex]+t[this.gIndex]+t[this.bIndex]}},{key:"hexVal",value:function(t){return t.toString(16)}},{key:"rgbVal",value:function(t){var e;return null===(e=t.slice(1).match(/.{1,2}/g))||void 0===e?void 0:e.map(function(t){return Number("0x".concat(t))})}},{key:"plot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#4be11e",i=this.rgbVal(e);i?(t[this.rIndex]=i[0],t[this.gIndex]=i[1],t[this.bIndex]=i[2]):console.log("bad colour")}}]),t}(),k={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},E=[[-1,0,1],[-2,0,2],[-1,0,1]],j=[[-1,-2,-1],[0,0,0],[1,2,1]],O={bitDepth:32,mode:"periodic"};var C=Object(y.a)(function t(e){var i=this;Object(x.a)(this,t),this.THICKNESS=2,this.ctx=void 0,this.numAngleCells=360,this.rhoMax=void 0,this.accum=new Array(this.numAngleCells),this.drawingWidth=void 0,this.drawingHeight=void 0,this.cosTable=new Array(this.numAngleCells),this.sinTable=new Array(this.numAngleCells),this.distance=10,this.findMaxInHough=function(){for(var t=[],e=0;e<360;e++)for(var n=0;n<i.accum[e].length;n++){i.accum[e][n];var o=i.accum[e][n];if(o>160){var a=i.cosTable[e],s=i.sinTable[e],r=n;r<<=1,r-=i.rhoMax,t.push({x1:a*r+1e3*-s,y1:s*r+1e3*a,x2:a*r-1e3*-s,y2:s*r-1e3*a})}}var l=[];t=t.filter(function(t){var e=t.x1-t.x2<-5||t.x2-t.x1<-5,i=t.y1-t.y2<-5||t.y2-t.y1<-5;return!(e&&i)});for(var c=function(){var e=t.pop();l.push(e),t=t.filter(function(t){var n=(e.x1+e.x2)/2,o=(t.x1+t.x2)/2,a=(e.y1+e.y2)/2,s=(t.y1+t.y2)/2;return!(n+i.distance>o&&n-i.distance<o)||!(a+i.distance>s&&a-i.distance<s)})};t.length>0;)c();return console.log(l),l.forEach(function(t){console.log(t),i.ctx.beginPath(),i.ctx.strokeStyle="rgba(255,0,0,1)",i.ctx.moveTo(t.x1+i.drawingWidth/2,t.y1+i.drawingHeight/2),i.ctx.lineTo(t.x2+i.drawingWidth/2,t.y2+i.drawingHeight/2),i.ctx.stroke(),i.ctx.strokeStyle="rgba(0,0,0,1)",i.ctx.closePath()}),l},this.houghAcc=function(t,e){var n;console.log("running");var o=0;for(t-=i.drawingWidth/2,e-=i.drawingHeight/2;o<i.numAngleCells;o++)n=i.rhoMax+t*i.cosTable[o]+e*i.sinTable[o],n>>=1,void 0==i.accum[o]&&(i.accum[o]=[]),void 0==i.accum[o][n]?i.accum[o][n]=1:i.accum[o][n]++},this.drawingWidth=e.width,this.drawingHeight=e.height,this.rhoMax=Math.sqrt(this.drawingWidth*this.drawingWidth+this.drawingHeight*this.drawingHeight),this.ctx=e.getContext("2d");for(var n=0,o=0;o<this.numAngleCells;n+=Math.PI/this.numAngleCells,o++)this.cosTable[o]=Math.cos(n),this.sinTable[o]=Math.sin(n)}),I=i(71),L=Object(y.a)(function t(e,i){Object(x.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=i}),R=i(12),V=i(70),T=function(){function t(e,i,n,o,a){Object(x.a)(this,t),this.id=void 0,this.ctx=void 0,this.canvas=void 0,this.topLeft=void 0,this.bottomRight=void 0,this.intialised=void 0,this.width=void 0,this.height=void 0,this.numbers=void 0,this.provisonal=void 0,this.number="",this.pos=void 0,this.sq=void 0,this.row=void 0,this.col=void 0,this.filteredPos=void 0,this.id=e,this.ctx=i,this.topLeft=new L(o.x,o.y),this.bottomRight=new L(a.x,a.y),this.canvas=n,this.intialised=!1,this.width=this.bottomRight.x-this.topLeft.x,this.height=this.bottomRight.y-this.topLeft.y,this.numbers=["1","2","3","4","5","6","7","8","9"];var s=this.percent(this.height,15),r=this.percent(this.width,15);this.bottomRight.y=this.bottomRight.y-s,this.bottomRight.x=this.bottomRight.x-r,this.topLeft.y=this.topLeft.y+s,this.topLeft.x=this.topLeft.x+r,this.width=this.bottomRight.x-this.topLeft.x,this.height=this.bottomRight.y-this.topLeft.y,this.provisonal=!1}return Object(y.a)(t,[{key:"getPos",value:function(){var t=this,e=this.pos&&this.pos.length>0?this.pos:this.numbers;this.pos=e.filter(function(e){return!(t.inList(t.row,e)||t.inList(t.col,e)||t.inList(t.sq,e))})}},{key:"filterPos",value:function(){this.tryFilter(this.sq),this.tryFilter(this.row),this.tryFilter(this.col)}},{key:"tryFilter",value:function(t){var e=this,i=[];this.row.filter(function(t){return!t.number&&t.id!=e.id}).forEach(function(t){return i.push.apply(i,Object(R.a)(t.pos))}),this.col.filter(function(t){return!t.number&&t.id!=e.id}).forEach(function(t){return i.push.apply(i,Object(R.a)(t.pos))}),t.filter(function(t){return!t.number&&t.id!=e.id}).forEach(function(t){return i.push.apply(i,Object(R.a)(t.pos))}),this.filteredPos=this.pos.filter(function(t){return!i.includes(t)}),this.filteredPos.length>0&&this.filteredPos.length<this.pos.length&&(this.pos=this.filteredPos,console.log(i),console.log(this.pos),console.log(this.filteredPos))}},{key:"inList",value:function(t,e){return 0!=t.filter(function(t){return t.number===e}).length}},{key:"percent",value:function(t,e){return t/100*e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yellow";this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.moveTo(this.topLeft.x,this.topLeft.y),this.ctx.lineTo(this.bottomRight.x,this.topLeft.y),this.ctx.lineTo(this.bottomRight.x,this.bottomRight.y),this.ctx.lineTo(this.topLeft.x,this.bottomRight.y),this.ctx.lineTo(this.topLeft.x,this.topLeft.y),this.ctx.closePath(),this.ctx.fill()}},{key:"blank",value:function(){this.draw("white"),this.number="",this.pos=[],this.intialised=!0,this.provisonal=!0}},{key:"callback",value:function(t){var e=this;this.isEmpty()?this.blank():(document.body.style.backgroundImage="url("+t+")",V.Tesseract.recognize(t,"eng").progress(console.log).then(function(t){console.log(t.text);var i=t.text?t.text.replace(/[^0-9]/g,"").substring(0,1):"";i?(e.number=i,e.drawLetter(),e.intialised=!0,e.provisonal=!1,console.log("The number you are looking at is a ".concat(t.text," in square ").concat(e.toString()))):(console.log("Nothing found in square ".concat(e.toString())),e.blank())}).catch(function(){e.callback(t)}))}},{key:"getLetter",value:function(){var t=this.topLeft.x,e=this.topLeft.y,i=this.bottomRight.x-this.topLeft.x,n=this.bottomRight.y-this.topLeft.y,o=document.createElement("canvas"),a=o.getContext("2d");o.width=i,o.height=n,a&&a.drawImage(this.canvas,t,e,i,n,0,0,o.width,o.height),this.callback(o.toDataURL())}},{key:"drawLetter",value:function(){this.ctx.fillStyle="black",this.ctx.font="25px Courier New",this.ctx.fillText(this.number,this.topLeft.x,this.bottomRight.y)}},{key:"toString",value:function(){return"|".concat(this.number,"|")}},{key:"isEmpty",value:function(){for(var t,e,i=this.ctx.getImageData(this.topLeft.x,this.topLeft.y,this.width,this.height),n=0,o=0,a=0;a+3<i.data.length;a+=4)t=i.data[a],e=i.data[a+1],t+i.data[a+2]+e<255&&o++,n++;return!(o/(n/100)>15)}}]),t}(),Y=function(){function t(){Object(x.a)(this,t),this.cols=void 0,this.rows=void 0,this.squares=void 0,this.solvefailed=void 0,this.cells=void 0,this.colours=["teal","cyan","pink","magenta","lightgrey","yellow","red","lime","orange"],this.cols=[[],[],[],[],[],[],[],[],[]],this.rows=[],this.squares=[],this.solvefailed=!1}return Object(y.a)(t,[{key:"populateBoard",value:function(t){var e=this;this.cells=t;for(var i=0;i<9;i++){var n=9*i,o=n+9;this.rows.push(this.cells.slice(n,o))}this.rows.forEach(function(t,i){t.forEach(function(t,n){e.cols[n][i]=e.rows[i][n]})});for(i=0;i<3;i++)for(var a=this.rows.slice(3*i,3*i+3),s=0;s<3;s++){var r=3*s,l=r+3,c=[];c.push.apply(c,Object(R.a)(a[0].slice(r,l))),c.push.apply(c,Object(R.a)(a[1].slice(r,l))),c.push.apply(c,Object(R.a)(a[2].slice(r,l))),this.squares.push(c)}this.cells.forEach(function(t){return e.populateCellData(t)}),console.log(this.cols),console.log(this.rows),console.log(this.squares)}},{key:"getRandomInt",value:function(t){return Math.floor(Math.random()*t)}},{key:"solve",value:function(){var t=this,e=!1;this.updatePossible(),this.filterPossible();var i=this.cells.filter(function(t){return!t.number});if(i.filter(function(t){return 0==t.pos.length}).length>0)this.failed();else{if(i.filter(function(t){return 1==t.pos.length}).forEach(function(i){e||(t.fillCell(i,i.pos[t.getRandomInt(i.pos.length)]),e=!0,t.solvefailed=!e)}),this.solvefailed){var n=i.filter(function(t){return t.pos.length>1&&t.pos.length<4}),o=i.filter(function(t){return t.pos.length>1&&t.pos.length<4})[this.getRandomInt(n.length)];return this.fillCell(o,o.pos[this.getRandomInt(o.pos.length)]),e=!0,void(this.solvefailed=!e)}this.solvefailed=!e}}},{key:"updatePossible",value:function(){this.cells.filter(function(t){return!t.number}).forEach(function(t){t.getPos()})}},{key:"filterPossible",value:function(){this.cells.filter(function(t){return!t.number}).forEach(function(t){t.filterPos()})}},{key:"fillCell",value:function(t,e){t.number=e,t.draw(this.colours[+e-1]),t.drawLetter(),this.solvefailed=!1}},{key:"failed",value:function(){var t=this;this.cells.filter(function(t){return t.provisonal}).forEach(function(t){return t.draw("pink")}),setTimeout(function(){t.clearBoard()},250)}},{key:"clearBoard",value:function(){this.cells.filter(function(t){return t.provisonal}).forEach(function(t){return t.blank()})}},{key:"solved",value:function(){return 0===this.cells.filter(function(t){return!t.number}).length}},{key:"populateCellData",value:function(t){t.row=this.getRow(t),t.col=this.getCol(t),t.sq=this.getSquare(t)}},{key:"getRow",value:function(t){return this.rows.filter(function(e){return 1==e.filter(function(e){return e.id===t.id}).length})[0]}},{key:"getCol",value:function(t){return this.cols.filter(function(e){return 1==e.filter(function(e){return e.id===t.id}).length})[0]}},{key:"getSquare",value:function(t){return this.squares.filter(function(e){return 1==e.filter(function(e){return e.id===t.id}).length})[0]}}]),t}(),X=function(t){var e=t.canvas,i=e.getContext("2d"),a=Object(n.useState)(!1),s=Object(r.a)(a,2),l=s[0],c=s[1],h=Object(n.useState)(null),u=Object(r.a)(h,2),f=u[0],g=u[1],d=Object(n.useState)(null),v=Object(r.a)(d,2),m=v[0],p=v[1],b=Object(n.useState)(null),x=Object(r.a)(b,2),y=x[0],R=x[1],V=Object(n.createRef)(),X=Object(n.createRef)(),M=[],P=[],S=new Y;Object(n.useEffect)(function(){setTimeout(function(){if(!y){for(var t=new Array,e=0;e<480;e++)for(var i=0;i<640;i++)t.push(new w(i,e,640));R(t)}},1)},[l]),Object(n.useEffect)(function(){setTimeout(function(){I.a.load(e.toDataURL("image/png").replace("image/png","image/octet-stream")).then(function(t){p(t.toDataURL());var e=t.grey();g(function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},k,e);for(var i=t.width,n=t.height,o=t.maxValue,a={sigma:e.gaussianBlur,radius:3},s=t.gaussianFilter(a),r=s.convolution(j,O),l=s.convolution(E,O),c=l.hypotenuse(r),h=t.constructor,u=new h(i,n,{kind:"GREY",bitDepth:32}),f=new h(i,n,{kind:"GREY",bitDepth:32}),g=new h(i,n,{kind:"GREY"}),d=1;d<i-1;d++)for(var v=1;v<n-1;v++){var m=(Math.round(Math.atan2(l.getValueXY(d,v,0),r.getValueXY(d,v,0))*(5/Math.PI))+5)%5;0===m&&(c.getValueXY(d,v,0)<=c.getValueXY(d,v-1,0)||c.getValueXY(d,v,0)<=c.getValueXY(d,v+1,0))||1===m&&(c.getValueXY(d,v,0)<=c.getValueXY(d-1,v+1,0)||c.getValueXY(d,v,0)<=c.getValueXY(d+1,v-1,0))||2===m&&(c.getValueXY(d,v,0)<=c.getValueXY(d-1,v,0)||c.getValueXY(d,v,0)<=c.getValueXY(d+1,v,0))||3===m&&(c.getValueXY(d,v,0)<=c.getValueXY(d-1,v-1,0)||c.getValueXY(d,v,0)<=c.getValueXY(d+1,v+1,0))||u.setValueXY(d,v,0,c.getValueXY(d,v,0))}for(d=0;d<i*n;++d){var p=u.data[d],b=0;p>e.highThreshold&&(b++,g.data[d]=o),p>e.lowThreshold&&b++,f.data[d]=b}var x=[];for(d=1;d<i-1;++d)for(v=1;v<n-1;++v)if(1===f.getValueXY(d,v,0))t:for(var y=d-1;y<d+2;++y)for(var w=v-1;w<v+2;++w)if(2===f.getValueXY(y,w,0)){x.push([d,v]),g.setValueXY(d,v,0,o);break t}for(;x.length>0;){var C=[];for(d=0;d<x.length;++d)for(v=-1;v<2;++v)for(y=-1;y<2;++y)if(0!==v||0!==y){var I=x[d][0]+v,L=x[d][1]+y;1===f.getValueXY(I,L,0)&&0===g.getValueXY(I,L,0)&&(C.push([I,L]),g.setValueXY(I,L,0,o))}x=C}return g}(e))})},1)},[y]);var F=function(){i.drawImage(V.current,0,0),W(),setTimeout(function(){A()},1e3)},A=function(){var t=new C(e),n=i.getImageData(0,0,640,480);i.drawImage(X.current,0,0),N(95),H(),y.forEach(function(e){var i=e.x>170&&e.x<470,o=e.y>90&&e.y<390;i&&o&&e.getColourMagnitued(n.data)>10&&t.houghAcc(e.x,e.y)});var o=t.findMaxInHough(),a=o.filter(function(t){return t.y1+5>t.y2&&t.y1-5<t.y2}),s=o.filter(function(t){return t.x1+5>t.x2&&t.x1-5<t.x2});a.forEach(function(t){s.forEach(function(e){q(e.x1+320,t.y1+240)})}),console.log(M),D(),_()},D=function(){M.reverse().forEach(function(t,n){if(n+11<M.length&&(n-9)%10!=0){var o=new T(n,i,e,t,M[n+11]);P.push(o)}}),P.forEach(function(t,e){setTimeout(function(){t.getLetter()},10*e)})},q=function(t,e){M.push(new L(t,e))},B=function(t){i.putImageData(t,0,0)},H=function(){var t=i.getImageData(0,0,640,480);y.forEach(function(e){e.getColourMagnitued(t.data)/3<100?e.plot(t.data,"#000000"):e.plot(t.data,"#FFFFFF")}),B(t)},W=function(){var t=i.getImageData(0,0,640,480);y.forEach(function(e){var i=e.x>170&&e.x<470,n=e.y>90&&e.y<390;i&&n||e.plot(t.data,"#000000")}),B(t)},N=function(t){for(var e=i.getImageData(0,0,640,480),n=128*(1-(t=t/100+1)),o=0;o<e.data.length;o+=4)e.data[o]=e.data[o]*t+n,e.data[o+1]=e.data[o+1]*t+n,e.data[o+2]=e.data[o+2]*t+n;B(e)},_=function t(){console.log("Waiting for sqaures to be done!"),setTimeout(0==P.filter(function(t){return!t.intialised}).length?G:t,1e3)},U=function(){console.log("we did it"),S.cells.forEach(function(t){S.fillCell(t,t.number)})},G=function(){S.populateBoard(P),function t(){S.solve(),console.log("HMMMMMM"),setTimeout(S.solved()?function(){U()}:t,10)}()};return l||c(!0),o.a.createElement(o.a.Fragment,null,f&&o.a.createElement("img",{onLoad:F,ref:V,src:f.toDataURL(),alt:"Captured Image",id:"image",hidden:!0}),m&&o.a.createElement("img",{ref:X,src:m,alt:"Captured Image",id:"image",hidden:!0}))};var M=function(){var t=Object(n.useState)(""),e=Object(r.a)(t,2),i=e[0],a=e[1],s=o.a.createElement(b,{ctxReady:a}),l=o.a.createElement(X,{canvas:i});return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},s,i&&l,o.a.createElement("img",{src:c.a,className:"App-logo",alt:"logo"})))},P=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,139)).then(function(e){var i=e.getCLS,n=e.getFID,o=e.getFCP,a=e.getLCP,s=e.getTTFB;i(t),n(t),o(t),a(t),s(t)})};s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(M,null)),document.getElementById("root")),P()},34:function(t,e,i){t.exports={uiButton:"Camera_uiButton__1P_j6",CameraWrapper:"Camera_CameraWrapper__24Xq_"}},58:function(t,e,i){t.exports=i.p+"static/media/logo.06e73328.svg"},60:function(t,e,i){t.exports=i.p+"static/media/camera.c4363820.svg"},61:function(t,e,i){t.exports=i.p+"static/media/bin.3fd11e65.svg"},73:function(t,e,i){t.exports=i(138)},78:function(t,e,i){},79:function(t,e,i){}},[[73,1,2]]]);
//# sourceMappingURL=main.a54e6751.chunk.js.map